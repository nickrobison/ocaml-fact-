(library
 (name fact_c)
 (public_name fact++.c)
 (preprocess no_preprocessing)
 (foreign_archives vendor)
 (c_library_flags :standard -lKernel -lstdc++))

(rule
 (deps (source_tree fact))
 (targets libvendor%{ext_lib} dllvendor%{ext_dll} libKernel%{ext_lib})
 (action
  (no-infer
   (progn
    (chdir fact (run cmake .))
    (chdir fact (run make fact factShared))
    (copy fact/FaCT++.C/libfact%{ext_lib} libvendor%{ext_lib})
    (copy fact/FaCT++.C/libfact%{ext_dll} dllvendor%{ext_dll})
    (copy fact/Kernel/libKernel%{ext_lib} libKernel%{ext_lib})
))))

(data_only_dirs fact)
